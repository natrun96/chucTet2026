<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gieo Qu·∫ª ƒê·∫ßu NƒÉm 2026</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üßß</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    
    <style>
        /* --- 1. C·∫§U H√åNH CHUNG --- */
        body {
            margin: 0; padding: 0; display: flex; justify-content: center; align-items: center;
            height: 100vh;
            background: linear-gradient(135deg, #8a0000 0%, #ff1a1a 100%);
            font-family: 'Segoe UI', Roboto, Arial, sans-serif;
            overflow: hidden; text-align: center; color: white;
        }

        /* --- 2. NG·ª∞A PHI --- */
        .horse-container {
            position: absolute; bottom: 15px; left: -300px;
            z-index: 5; pointer-events: none;
            display: flex; gap: -20px;
            animation: runAcross 7s linear infinite;
        }
        .horse-unit {
            font-size: 80px; display: inline-block;
            transform: scaleX(-1);
            filter: drop-shadow(5px 5px 5px rgba(0,0,0,0.5));
        }
        .galloping { animation: gallop 0.6s ease-in-out infinite alternate; }
        .horse-red { filter: hue-rotate(-50deg) saturate(2) drop-shadow(5px 5px 5px rgba(0,0,0,0.5)); }
        .horse-gold { filter: hue-rotate(45deg) saturate(3) brightness(1.2) drop-shadow(5px 5px 5px rgba(0,0,0,0.5)); animation-delay: 0.1s; }
        .horse-brown { animation-delay: 0.2s; }
        @keyframes runAcross { 0% { left: -300px; } 100% { left: 110vw; } }
        @keyframes gallop { 0% { transform: scaleX(-1) translateY(0) rotate(0deg); } 100% { transform: scaleX(-1) translateY(-20px) rotate(5deg); } }

        /* --- 3. UI ELEMENT C∆† B·∫¢N --- */
        .sound-control {
            position: fixed; top: 20px; right: 20px;
            width: 40px; height: 40px; 
            background: rgba(0, 0, 0, 0.6); border: 2px solid #ffd700; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            font-size: 22px; cursor: pointer; z-index: 200; 
            transition: transform 0.2s; animation: pulse-btn 2s infinite;
        }
        
        .speaker-hint {
            position: fixed; top: 25px; right: 75px; 
            z-index: 200; 
            color: #fff; font-size: 14px; font-weight: bold;
            background: #d00000; 
            padding: 8px 15px; border-radius: 30px;
            border: 2px solid #ffd700; 
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
            pointer-events: none; 
            display: flex; align-items: center; gap: 5px;
            animation: hint-bounce 1s infinite alternate;
            white-space: nowrap; 
        }
        .speaker-hint::after { content: '‚û°Ô∏è'; font-size: 18px; }

        @keyframes hint-bounce { 0% { transform: translateX(0); } 100% { transform: translateX(-5px); } }
        @keyframes pulse-btn { 0% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(255, 215, 0, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0); } }

        /* --- 4. BAO L√å X√å --- */
        #envelope {
            width: 300px; height: 450px;
            background: linear-gradient(to bottom, #b30000, #e60000);
            border: 4px solid #ffd700; border-radius: 20px;
            cursor: pointer; display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            box-shadow: 0 10px 50px rgba(0,0,0,0.7);
            transition: transform 0.3s; z-index: 20; position: relative;
            margin-bottom: 80px; 
        }
        #envelope:hover { transform: scale(1.05); }
        .envelope-icon { font-size: 80px; margin-bottom: -10px; filter: drop-shadow(0 4px 4px rgba(0,0,0,0.3)); }
        .year-text { font-size: 35px; font-weight: 900; color: #ffd700; text-shadow: 3px 3px 0px #8b0000; font-family: 'Arial Black', sans-serif; margin-bottom: 10px; }
        .click-hint { font-size: 18px; font-weight: bold; margin-top: 20px; animation: blink 1.5s infinite; }
        @keyframes blink { 50% { opacity: 0.5; } }

        /* --- (ƒê√É X√ìA PH·∫¶N #nameSelection) --- */

        /* --- 6. N·ªòI DUNG CH√çNH (L·ªúI CH√öC) --- */
        #content {
            display: none; background: #fffaf0;
            padding: 25px 20px; border-radius: 20px;
            box-shadow: 0 0 60px rgba(255, 204, 0, 0.9);
            width: 360px; max-width: 90%;
            border: 3px solid #d41414;
            position: relative; z-index: 20;
            margin-bottom: 100px;
            animation: popIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            max-height: 85vh; overflow-y: auto; 
            scroll-behavior: smooth; 
        }
        @keyframes popIn { 0% { opacity: 0; transform: scale(0.5); } 100% { opacity: 1; transform: scale(1); } }

        h1.title-tet { color: #d00000; font-size: 24px; font-weight: bold; margin-bottom: 5px; margin-top: 5px;}
        .horse-icons-top { font-size: 28px; margin: 0px 0 10px 0; }
        
        /* CSS CHO L·ªúI CH√öC & B√öT */
        .wishes { 
            font-size: 16px; line-height: 1.6; color: #333; font-style: italic; font-weight: 600; 
            background: #fff; padding: 15px; border-radius: 10px; border: 1px dashed #d00000; margin-bottom: 20px;
            text-align: left;
        }
        
        .highlight-text {
            display: block; text-align: center; 
            font-size: 26px; font-weight: bold; 
            color: #d00000; font-style: italic; 
            margin-top: 15px; text-shadow: 1px 1px 0px rgba(255,255,255,0.5);
        }

        .writing-pen {
            display: inline-block; font-size: 20px;
            margin-left: 5px;
            animation: write-move 0.3s infinite alternate;
        }
        @keyframes write-move {
            0% { transform: rotate(0deg) translateY(0); }
            100% { transform: rotate(15deg) translateY(-5px); }
        }

        /* --- CSS ·∫¢NH NAM.JPG --- */
        #extra-image-container {
            display: none; margin-bottom: 15px;
        }

        .my-custom-img {
            width: 100%; 
            max-width: 100%; 
            border-radius: 10px; border: 3px solid #d00000;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: block; margin: 0 auto;
            
            /* HI·ªÜU ·ª®NG CINE DREAMY - T·ªëc ƒë·ªô 1.5s */
            opacity: 0;
            filter: blur(20px) brightness(1.2); 
            transform: scale(1.1); 
            
            animation: cinematicReveal 1.5s ease-out forwards;
        }

        @keyframes cinematicReveal {
            0% { opacity: 0; filter: blur(20px) brightness(1.5); transform: scale(1.15); }
            50% { opacity: 0.8; filter: blur(5px) brightness(1.1); }
            100% { opacity: 1; filter: blur(0) brightness(1); transform: scale(1); }
        }

        .btn-lucky {
            display: none; 
            padding: 12px 30px;
            background: linear-gradient(to right, #ffd700, #fdb931);
            color: #d00000; font-weight: bold; border-radius: 50px;
            border: 2px solid #fff; cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.5);
            font-size: 16px; transition: transform 0.2s;
            animation: pulse-gold 1.5s infinite;
        }
        @keyframes pulse-gold {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7); }
            50% { transform: scale(1.05); box-shadow: 0 0 0 15px rgba(255, 215, 0, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 215, 0, 0); }
        }

        /* --- 7. C√ÅC POPUP KH√ÅC --- */
        #qrOverlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(100, 0, 0, 0.5); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); z-index: 2000; justify-content: center; align-items: center; flex-direction: column; animation: fadeIn 0.5s; overflow-y: auto; padding: 20px 0; }
        .btn-close-qr { position: absolute; top: 30px; right: 30px; color: #fff; font-size: 40px; cursor: pointer; opacity: 0.8; transition: 0.3s; text-shadow: 0 0 10px rgba(0,0,0,0.5); z-index: 2005; }
        .btn-close-qr:hover { opacity: 1; transform: scale(1.1); }
        .qr-title-large { color: #ffd700; font-size: 28px; font-weight: bold; margin-bottom: 20px; letter-spacing: 1px; text-shadow: 2px 2px 4px rgba(0,0,0,0.6); margin-top: 50px; }
        .qr-img-large { width: 260px; height: 260px; border: 5px solid #ffd700; border-radius: 15px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5); background: white; margin-bottom: 10px; cursor: zoom-in; transition: transform 0.2s; }
        .qr-img-large:hover { transform: scale(1.02); }
        #qrLightbox { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 9999; justify-content: center; align-items: center; flex-direction: column; animation: fadeIn 0.3s; }
        .lightbox-img-content { width: auto; height: auto; max-width: 90%; max-height: 80vh; border: 3px solid #ffd700; border-radius: 10px; box-shadow: 0 0 30px rgba(255, 215, 0, 0.5); animation: zoomInPopup 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); cursor: zoom-out; }
        @keyframes zoomInPopup { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .lightbox-hint-text { color: #ccc; margin-top: 15px; font-style: italic; font-size: 14px; animation: blink 2s infinite; }
        .qr-note { color: #fff; font-style: italic; font-size: 16px; margin-bottom: 20px; text-shadow: 1px 1px 2px rgba(0,0,0,0.8); }
        .btn-download-bottom { display: flex; align-items: center; gap: 10px; padding: 10px 25px; background: #d00000; border: 2px solid #ffd700; color: #ffd700; border-radius: 50px; text-decoration: none; font-weight: bold; font-size: 16px; transition: 0.3s; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .btn-download-bottom:hover { transform: scale(1.05); background: #b30000; }
        .final-message { margin-top: 30px; margin-bottom: 50px; font-style: italic; color: #fff; font-size: 15px; max-width: 85%; line-height: 1.6; text-shadow: 0 1px 2px rgba(0,0,0,0.8); background: rgba(0, 0, 0, 0.4); border: 1px dashed #ffd700; padding: 15px 20px; border-radius: 15px; opacity: 0; animation: fadeMsg 2s ease-in-out forwards; animation-delay: 0.5s; }
        @keyframes fadeMsg { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        #shakingModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); z-index: 3000; justify-content: center; align-items: center; flex-direction: column; }
        .fortune-container { width: 100px; height: 160px; background: linear-gradient(to right, #b30000, #d00000, #b30000); border: 4px solid #ffd700; border-radius: 10px 10px 30px 30px; position: relative; animation: shake-hard 0.4s ease-in-out infinite; box-shadow: 0 10px 30px rgba(0,0,0,0.6); }
        .fortune-container::before { content: ''; position: absolute; top: -15px; left: 5px; width: 82px; height: 25px; background: #800000; border: 4px solid #ffd700; border-radius: 50%; z-index: 2; }
        .sticks-bundle { position: absolute; top: -40px; left: 20px; width: 60px; height: 60px; z-index: 1; }
        .stick-sample { position: absolute; width: 10px; height: 80px; background: #f0e68c; border-radius: 5px; border: 1px solid #d4a017; }
        .stick-sample:nth-child(1) { left: 10px; transform: rotate(-15deg); top: 10px; } .stick-sample:nth-child(2) { left: 25px; transform: rotate(0deg); top: 0px; } .stick-sample:nth-child(3) { left: 40px; transform: rotate(15deg); top: 10px; }
        @keyframes shake-hard { 0% { transform: rotate(0deg) translateY(0); } 25% { transform: rotate(-10deg) translateY(-10px); } 50% { transform: rotate(0deg) translateY(0); } 75% { transform: rotate(10deg) translateY(10px); } 100% { transform: rotate(0deg) translateY(0); } }
        .shaking-text { color: #ffd700; font-size: 22px; font-weight: bold; margin-top: 40px; text-shadow: 0 0 10px #d00000; animation: blink 1s infinite; }
        #resultModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); z-index: 3000; justify-content: center; align-items: center; animation: fadeIn 0.3s; }
        .bamboo-card { width: 300px; min-height: 450px; background: #fdf5e6; border: 8px solid #d4a017; border-radius: 15px; position: relative; display: flex; flex-direction: column; align-items: center; padding: 0; box-shadow: 0 0 50px rgba(255, 215, 0, 0.5); transform: scale(0.1); opacity: 0; animation: card-reveal 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; overflow: hidden; }
        .card-header { width: 100%; height: 70px; background: #d00000; display: flex; justify-content: center; align-items: center; color: #ffd700; font-size: 35px; font-weight: 900; border-bottom: 4px solid #d4a017; text-transform: uppercase; }
        .card-body { padding: 20px; width: 100%; box-sizing: border-box; text-align: center; color: #5c4033; background-image: linear-gradient(#fdf5e6 1px, transparent 1px), linear-gradient(90deg, #fdf5e6 1px, transparent 1px); background-size: 20px 20px; }
        .fortune-rank { display: inline-block; font-size: 24px; font-weight: bold; font-family: 'Dancing Script', cursive, sans-serif; background: linear-gradient(to right, #d00000, #ff0000); -webkit-background-clip: text; -webkit-text-fill-color: transparent; border: 2px solid #d00000; padding: 5px 20px; border-radius: 50px; margin-bottom: 20px; text-transform: uppercase; white-space: nowrap; animation: heartbeat 2s infinite; }
        @keyframes heartbeat { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        .fortune-content p { font-size: 16px; margin: 10px 0; font-weight: 600; border-bottom: 1px dashed #ccc; padding-bottom: 5px; }
        .fortune-content b { color: #d00000; font-size: 18px; }
        .poem { margin-top: 15px; font-style: italic; color: #800000; font-weight: bold; }
        .btn-get-money-card { margin-top: auto; margin-bottom: 20px; background: linear-gradient(to right, #d00000, #ff0000); color: #fff; border: none; padding: 12px 30px; border-radius: 50px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.3); font-size: 16px; animation: pulse-gold 1.5s infinite; }
        @keyframes card-reveal { 0% { transform: translateY(200px) scale(0.5); opacity: 0; } 100% { transform: translateY(0) scale(1); opacity: 1; } }
        .flower { position: absolute; top: -10vh; z-index: 10; pointer-events: none; opacity: 0.8; }
        .firework-shell { position: absolute; top: 0; left: 0; pointer-events: none; z-index: 5; }
        .firework-particle { position: absolute; border-radius: 50%; animation: realistic-burst 1.2s ease-out forwards, twinkle 0.2s infinite alternate; }
        @keyframes realistic-burst { 0% { transform: translate(0, 0) scale(1); opacity: 1; } 60% { transform: translate(var(--x), var(--y)) scale(0.8); opacity: 0.8; } 100% { transform: translate(var(--x), calc(var(--y) + 100px)) scale(0.4); opacity: 0; } }
        @keyframes twinkle { from { opacity: 1; } to { opacity: 0.7; } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>

<body onclick="playAudioForce()">

    <div id="shakingModal">
        <div class="fortune-container">
            <div class="sticks-bundle">
                <div class="stick-sample"></div>
                <div class="stick-sample"></div>
                <div class="stick-sample"></div>
            </div>
        </div>
        <div class="shaking-text">ƒêang xin keo... üôè</div>
    </div>

    <div id="resultModal">
        <div class="bamboo-card">
            <div class="card-header"><div>L·ªôc</div></div>
            <div class="card-body">
                <div class="fortune-rank" id="fortune-word">Ch·ªØ L·ªôc</div>
                <div class="fortune-content" id="fortune-details"></div>
                <div class="poem" id="fortune-poem"></div>
            </div>
            <button class="btn-get-money-card" onclick="revealQR()">Nh·∫≠n L·ªôc Ngay üßß</button>
        </div>
    </div>

    <div id="qrLightbox" onclick="closeLightbox()">
        <img src="" id="lightboxImg" class="lightbox-img-content">
        <div class="lightbox-hint-text">(Ch·∫°m ƒë·ªÉ ƒë√≥ng)</div>
    </div>

    <div id="qrOverlay">
        <div class="btn-close-qr" onclick="closeQR()">√ó</div>
        
        <div class="qr-title-large" id="qrTitle">L√¨ x√¨ t·∫∑ng em</div>
        
        <img src="" alt="QR Code" class="qr-img-large" id="qrImgMain" onclick="openLightbox(this.src)">
        
        <div class="qr-note">(Qu√©t b·∫±ng APP Viettel Money<br>Ch·∫°m v√†o m√£ QR ƒë·ªÉ ph√≥ng to)</div>
        
        <a href="" download="LiXi_Tet_2026.jpg" class="btn-download-bottom" id="btnDownload">
            <span>‚¨áÔ∏è</span> T·∫£i m√£ QR v·ªÅ
        </a>
        
        <div class="final-message" id="finalMsg">
            </div>
    </div>

    <div class="horse-container">
        <div class="horse-unit horse-red galloping">üêé</div>
        <div class="horse-unit horse-gold galloping">üêé</div>
        <div class="horse-unit horse-brown galloping">üêé</div>
    </div>

    <div id="envelope" onclick="openEnvelope()">
        <div class="envelope-icon">üßß</div>
        <div class="year-text">Xu√¢n B√≠nh Ng·ªç<br>2026</div>
        <div class="click-hint">·∫§n v√†o ƒë√¢y <br> ƒë·ªÉ nh·∫≠n l·ªôc ƒë·∫ßu nƒÉm nha </div>
    </div>

    <div id="content">
        <h1 class="title-tet">Ch√∫c M·ª´ng NƒÉm M·ªõi<br>Xu√¢n B√≠nh Ng·ªç 2026!</h1>
        <div class="horse-icons-top">üêé üêé üêé</div>
        
        <div id="extra-image-container">
            <img src="Anh-2.jpg" id="mainImage" alt="M·∫°nh m·∫Ω nh∆∞ ng·ª±a" class="my-custom-img">
        </div>

        <div class="wishes">
            <span id="type-text"></span>
            <span id="writing-pen" class="writing-pen">üñåÔ∏è</span>
        </div>

        <div id="btnLucky" class="btn-lucky" onclick="startShaking()">
            ‚ú® R√∫t Qu·∫ª L·ªôc ƒê·∫ßu NƒÉm üßß
        </div>
    </div>

    <div id="speakerHint" class="speaker-hint">Click m·ªü loa ƒë·ªÉ nghe nh·∫°c nha</div>
    <div id="soundBtn" class="sound-control" onclick="toggleSound(event)">üîá</div>

    <audio id="tetMusic" loop>
        <source src="nhac-tet.mp3" type="audio/mpeg">
    </audio>

    <script>
        var music = document.getElementById('tetMusic');
        var soundBtn = document.getElementById('soundBtn');
        var speakerHint = document.getElementById('speakerHint'); 
        var isPlaying = false;

        // --- C·∫§U H√åNH D·ªÆ LI·ªÜU C√Å NH√ÇN H√ìA ƒê·∫¶Y ƒê·ª¶ ---
        const PERSON_DATA = {
            "sep_tung": {
                group: "boss", // Nh√≥m S·∫øp
                wish: "NƒÉm m·ªõi em k√≠nh ch√∫c Anh c√πng gia ƒë√¨nh d·ªìi d√†o s·ª©c kh·ªèe - h·∫°nh ph√∫c - b√¨nh an - v·∫°n s·ª± nh∆∞ √Ω. Ch√∫c Ph√≤ng m√¨nh s·∫Ω ho√†n th√†nh v∆∞·ª£t m·ªçi ch·ªâ ti√™u v√† ƒë·∫°t nhi·ªÅu th√†nh t√≠ch cao trong nƒÉm 2026. Em c·∫£m ∆°n Anh ƒë√£ lu√¥n chia s·∫ª v√† h·ªó tr·ª£ ·∫°.",
                fortune: {
                    word: "Th·ªëng Lƒ©nh",
                    content: "<p><b>üëë S·ª± Nghi·ªáp:</b><br>Quy·∫øt ƒëo√°n, d·∫´n d·∫Øt ƒë·ªôi ng≈© v∆∞∆°n xa.</p><p><b>üí∞ T√†i L·ªôc:</b><br>V·ªØng v√†ng, gia tƒÉng kh√¥ng ng·ª´ng.</p><p><b>üè° Gia ƒê·∫°o:</b><br>An khang, th·ªãnh v∆∞·ª£ng, sum v·∫ßy.</p>",
                    poem: "\"C·∫ßm qu√¢n v·ªØng l√°i thuy·ªÅn ra bi·ªÉn<br>V·∫°n s·ª± hanh th√¥ng, ph√∫c l·ªôc ti·ªÅn\""
                }
            },
            "sep_doanh": {
                group: "boss",
                wish: "NƒÉm m·ªõi em k√≠nh ch√∫c Anh c√πng gia ƒë√¨nh d·ªìi d√†o s·ª©c kh·ªèe - h·∫°nh ph√∫c - b√¨nh an - v·∫°n s·ª± nh∆∞ √Ω. Ch√∫c Team m√¨nh s·∫Ω lu√¥n ƒëo√†n k·∫øt, c√πng h·ªó tr·ª£ nhau ho√†n th√†nh t·ªët m·ªçi nhi·ªám v·ª• trong nƒÉm 2026. Em c·∫£m ∆°n Anh ƒë√£ lu√¥n chia s·∫ª v√† h·ªó tr·ª£ ·∫°.",
                fortune: {
                    word: "ƒê·∫Øc Th·∫Øng",
                    content: "<p><b>ü§ù ƒê·ªìng ƒê·ªôi:</b><br>Tr√™n d∆∞·ªõi m·ªôt l√≤ng, s·ª©c m·∫°nh v√¥ song.</p><p><b>üöÄ C√¥ng Vi·ªác:</b><br>Thu·∫≠n bu·ªìm xu√¥i gi√≥, thƒÉng ti·∫øn cao.</p><p><b>üí∞ Ti·ªÅn B·∫°c:</b><br>R·ªßng r·ªânh, ƒë·∫ßu t∆∞ ƒë√¢u th·∫Øng ƒë√≥.</p>",
                    poem: "\"Ph√≥ t∆∞·ªõng t√†i ba, m∆∞u l∆∞·ª£c gi·ªèi<br>C√¥ng th√†nh danh to·∫°i, l·ªôc ƒë·∫ßy nh√†\""
                }
            },
            // Nh√≥m Em
            "e_linh": {
                group: "member", // Nh√≥m Member
                wish: "NƒÉm m·ªõi ch√∫c em s·ª©c kh·ªèe - nhi·ªÅu ni·ªÅm vui - g·∫∑p th·∫≠t nhi·ªÅu may m·∫Øn, c√¥ng vi·ªác su√¥n s·∫ª, thu·∫≠n l·ª£i, ho√†n th√†nh t·ªët m·ªçi b√†i to√°n ƒë∆∞·ª£c giao, v√† kh√¥ng ƒë·ªÉ l·ªçt con bug n√†o :D",
                fortune: {
                    word: "Nh∆∞ √ù",
                    content: "<p><b>üå∏ T√¨nh Duy√™n:</b><br>Hoa n·ªü r·ªô, ng∆∞·ªùi th∆∞∆°ng s·∫Ω t·ªõi.</p><p><b>üíª Code:</b><br>M∆∞·ª£t m√†, kh√¥ng bug, deploy m·ªôt ph√°t ƒÉn ngay.</p><p><b>üí∞ L∆∞∆°ng Th∆∞·ªüng:</b><br>TƒÉng ƒë·ªÅu ƒë·ªÅu, ti·ªÅn ti√™u r·ªßng r·ªânh.</p>",
                    poem: "\"Xu√¢n n√†y h∆°n h·∫≥n m·∫•y xu√¢n qua<br>Ph√∫c l·ªôc ƒë∆∞a nhau ƒë·∫øn t·∫≠n nh√†\""
                }
            },
            "e_kimanh": {
                group: "member",
                wish: "NƒÉm m·ªõi ch√∫c em s·ª©c kh·ªèe - nhi·ªÅu ni·ªÅm vui - g·∫∑p th·∫≠t nhi·ªÅu may m·∫Øn, c√¥ng vi·ªác su√¥n s·∫ª, thu·∫≠n l·ª£i, ho√†n th√†nh t·ªët m·ªçi b√†i to√°n ƒë∆∞·ª£c giao, v√† kh√¥ng ƒë·ªÉ l·ªçt con bug n√†o :D",
                fortune: {
                    word: "C√°t T∆∞·ªùng",
                    content: "<p><b>üíÑ Nhan S·∫Øc:</b><br>Ng√†y c√†ng thƒÉng h·∫°ng, r·∫°ng r·ª° xinh t∆∞∆°i.</p><p><b>üíº S·ª± Nghi·ªáp:</b><br>Qu√Ω nh√¢n ph√π tr·ª£, thƒÉng ti·∫øn v√π v√π.</p><p><b>üçÄ May M·∫Øn:</b><br>ƒêi ƒë√¢u c≈©ng g·∫∑p ƒëi·ªÅu l√†nh.</p>",
                    poem: "\"C√°t t∆∞·ªùng nh∆∞ √Ω, v·∫°n s·ª± an<br>T√†i l·ªôc quanh nƒÉm, ph√∫c ng·∫≠p tr√†n\""
                }
            },
            "e_trung": {
                group: "member",
                wish: "NƒÉm m·ªõi ch√∫c em s·ª©c kh·ªèe - nhi·ªÅu ni·ªÅm vui - g·∫∑p th·∫≠t nhi·ªÅu may m·∫Øn, c√¥ng vi·ªác su√¥n s·∫ª, thu·∫≠n l·ª£i, ho√†n th√†nh t·ªët m·ªçi b√†i to√°n ƒë∆∞·ª£c giao, v√† kh√¥ng ƒë·ªÉ l·ªçt con bug n√†o :D",
                fortune: {
                    word: "ƒê·ªôt Ph√°",
                    content: "<p><b>üß† Tr√≠ Tu·ªá:</b><br>S√°ng su·ªët, gi·∫£i quy·∫øt m·ªçi v·∫•n ƒë·ªÅ h√≥c b√∫a.</p><p><b>üèÉ S·ª©c Kh·ªèe:</b><br>D·∫ªo dai, b·ªÅn b·ªâ nh∆∞ ng·ª±a chi·∫øn.</p><p><b>üìà Th√†nh C√¥ng:</b><br>ƒê·∫°t ƒë∆∞·ª£c c·ªôt m·ªëc quan tr·ªçng m·ªõi.</p>",
                    poem: "\"Ch√≠ l·ªõn tung ho√†nh tr·ªùi ƒë·∫•t r·ªông<br>C√¥ng danh s·ª± nghi·ªáp s√°ng b·ª´ng l√™n\""
                }
            },
            "e_vinh": {
                group: "member",
                wish: "NƒÉm m·ªõi ch√∫c em s·ª©c kh·ªèe - nhi·ªÅu ni·ªÅm vui - g·∫∑p th·∫≠t nhi·ªÅu may m·∫Øn, c√¥ng vi·ªác su√¥n s·∫ª, thu·∫≠n l·ª£i, ho√†n th√†nh t·ªët m·ªçi b√†i to√°n ƒë∆∞·ª£c giao, v√† kh√¥ng ƒë·ªÉ l·ªçt con bug n√†o :D",
                fortune: {
                    word: "T√†i L·ªôc",
                    content: "<p><b>üí∞ V√≠ Ti·ªÅn:</b><br>L√∫c n√†o c≈©ng d√†y, ti√™u ho√†i kh√¥ng h·∫øt.</p><p><b>üõ†Ô∏è K·ªπ NƒÉng:</b><br>Level up v√π v√π, tr√πm m·ªçi d·ª± √°n.</p><p><b>üòÑ Tinh Th·∫ßn:</b><br>Lu√¥n l·∫°c quan, y√™u ƒë·ªùi ph∆°i ph·ªõi.</p>",
                    poem: "\"Ti·ªÅn v√†o c·ª≠a tr∆∞·ªõc, v√†ng c·ª≠a sau<br>Hai ch·ªØ gi√†u sang ƒë·∫øn r·∫•t mau\""
                }
            },
            "e_duc": {
                group: "member",
                wish: "NƒÉm m·ªõi ch√∫c em s·ª©c kh·ªèe - nhi·ªÅu ni·ªÅm vui - g·∫∑p th·∫≠t nhi·ªÅu may m·∫Øn, c√¥ng vi·ªác su√¥n s·∫ª, thu·∫≠n l·ª£i, ho√†n th√†nh t·ªët m·ªçi b√†i to√°n ƒë∆∞·ª£c giao, v√† kh√¥ng ƒë·ªÉ l·ªçt con bug n√†o :D",
                fortune: {
                    word: "B√¨nh An",
                    content: "<p><b>üßò T√¢m Tr√≠:</b><br>An y√™n, kh√¥ng lo √¢u, stress free.</p><p><b>üõ°Ô∏è C√¥ng Vi·ªác:</b><br>V·ªØng ch·∫Øc, ·ªïn ƒë·ªãnh, ƒë∆∞·ª£c tin t∆∞·ªüng.</p><p><b>üíñ T√¨nh C·∫£m:</b><br>·∫§m √°p, ƒë∆∞·ª£c m·ªçi ng∆∞·ªùi y√™u qu√Ω.</p>",
                    poem: "\"B√¨nh an hai ch·ªØ gi√° ng√†n v√†ng<br>Ph√∫ qu√Ω vinh hoa t·ª± x·∫øp h√†ng\""
                }
            }
        };

        const textPart2 = "2026 - M√£ ƒë√°o th√†nh c√¥ng";
        const typeSpeed = 35; 

        let charIndex = 0;
        let isTypingPart2 = false; 
        let selectedPerson = ""; 
        
        window.onload = function() {
            // L·∫•y tham s·ªë 'id' t·ª´ URL
            const urlParams = new URLSearchParams(window.location.search);
            const idParam = urlParams.get('id');

            // Ki·ªÉm tra xem ID c√≥ h·ª£p l·ªá kh√¥ng
            if (idParam && PERSON_DATA[idParam]) {
                selectedPerson = idParam;
            } else {
                // N·∫øu kh√¥ng c√≥ ID ho·∫∑c sai ID, m·∫∑c ƒë·ªãnh l√† ai ƒë√≥ (v√≠ d·ª• e_linh)
                // Ho·∫∑c b·∫°n c√≥ th·ªÉ t·∫°o 1 ID 'guest' chung
                selectedPerson = 'e_linh'; 
            }

            setInterval(createFlower, 350);
            setInterval(createFirework, 800);
            music.play().then(() => { 
                isPlaying = true; updateSoundIcon(true);
            }).catch(() => {
                updateSoundIcon(false);
            });
        };

        function updateSoundIcon(playing) {
            if (playing) { 
                soundBtn.innerHTML = 'üîä'; soundBtn.style.animation = 'none'; 
            } 
            else { 
                soundBtn.innerHTML = 'üîá'; soundBtn.style.animation = 'pulse-btn 2s infinite'; 
            }
        }

        function toggleSound(event) {
            event.stopPropagation();
            speakerHint.style.display = 'none';
            if (music.paused) { music.play(); isPlaying = true; updateSoundIcon(true); } 
            else { music.pause(); isPlaying = false; updateSoundIcon(false); }
        }

        function playAudioForce() {
            if (music.paused) {
                music.play().then(() => { 
                    isPlaying = true; updateSoundIcon(true); 
                }).catch((e) => console.log(e));
            }
        }

        function openEnvelope() {
            playAudioForce();
            speakerHint.style.display = 'none'; 
            document.getElementById('envelope').style.display = 'none';
            document.getElementById('content').style.display = 'block';
            showImageAndStartGreeting();
        }

        function showImageAndStartGreeting() {
            const imgContainer = document.getElementById("extra-image-container");
            const greetingImg = document.getElementById("mainImage"); 

            // --- LOGIC THAY ƒê·ªîI ·∫¢NH THEO NG∆Ø·ªúI CH·ªåN ---
            if (selectedPerson === 'sep_tung') {
                greetingImg.src = 'Anh-1.jpg'; // ·∫¢nh ri√™ng cho S·∫øp T√πng
            } else {
                greetingImg.src = 'Anh-2.jpg'; // ·∫¢nh chung cho m·ªçi ng∆∞·ªùi kh√°c
            }

            imgContainer.style.display = "block"; 
            setTimeout(typeWriter, 500);
        }

        function typeWriter() {
            const container = document.getElementById("type-text");
            const pen = document.getElementById("writing-pen");
            const textPart1 = PERSON_DATA[selectedPerson].wish;

            if (!isTypingPart2) {
                if (charIndex < textPart1.length) {
                    container.innerHTML += textPart1.charAt(charIndex);
                    charIndex++;
                    setTimeout(typeWriter, typeSpeed);
                } else {
                    isTypingPart2 = true;
                    charIndex = 0; 
                    const newSpan = document.createElement("span");
                    newSpan.className = "highlight-text"; 
                    newSpan.id = "highlight-span";
                    container.appendChild(newSpan); 
                    newSpan.appendChild(pen);
                    setTimeout(typeWriter, typeSpeed);
                }
            } 
            else {
                const highlightSpan = document.getElementById("highlight-span");
                if (charIndex < textPart2.length) {
                    const char = textPart2.charAt(charIndex);
                    const textNode = document.createTextNode(char);
                    highlightSpan.insertBefore(textNode, pen);
                    charIndex++;
                    setTimeout(typeWriter, typeSpeed);
                } else {
                    pen.style.display = "none";
                    
                    const btnLucky = document.getElementById("btnLucky");
                    btnLucky.style.display = "inline-block";
                    
                    const contentDiv = document.getElementById('content');
                    contentDiv.scrollTo({
                        top: contentDiv.scrollHeight,
                        behavior: 'smooth'
                    });
                }
            }
        }

        function startShaking() {
            document.getElementById('shakingModal').style.display = 'flex';
            const data = PERSON_DATA[selectedPerson].fortune;
            document.getElementById('fortune-word').innerHTML = data.word;
            document.getElementById('fortune-details').innerHTML = data.content;
            document.getElementById('fortune-poem').innerHTML = data.poem;

            setTimeout(function() {
                document.getElementById('shakingModal').style.display = 'none';
                document.getElementById('resultModal').style.display = 'flex';
            }, 3000);
        }

        // --- H√ÄM REVEAL QR M·ªöI (C·∫¨P NH·∫¨T THEO LOGIC M·ªöI) ---
        function revealQR() {
            // L·∫•y th√¥ng tin ng∆∞·ªùi hi·ªán t·∫°i
            const personInfo = PERSON_DATA[selectedPerson];
            const group = personInfo.group; // 'boss' ho·∫∑c 'member'

            // C√°c Element c·∫ßn thay ƒë·ªïi
            const qrTitle = document.getElementById('qrTitle');
            const qrImgMain = document.getElementById('qrImgMain');
            const btnDownload = document.getElementById('btnDownload');
            const finalMsg = document.getElementById('finalMsg');

            // --- C·∫¨P NH·∫¨T N·ªòI DUNG D·ª∞A TR√äN GROUP ---
            if (group === 'boss') {
                // D√†nh cho S·∫øp
                qrTitle.innerText = "Khai Xu√¢n ƒê·∫Øc L·ªôc";
                qrImgMain.src = "qr-sep.jpg";
                btnDownload.href = "qr-sep.jpg";
                finalMsg.innerText = "Tuy gi√° tr·ªã l√¨ x√¨ kh√¥ng l·ªõn, nh∆∞ng ƒë√¢y l√† t·∫•m l√≤ng th√†nh c·ªßa em g·ª≠i t·ªõi Anh nh√¢n d·ªãp ƒë·∫ßu xu√¢n nƒÉm m·ªõi. K√≠nh ch√∫c Anh m·ªôt nƒÉm B√≠nh Ng·ªç 2026 th·∫≠t nhi·ªÅu s·ª©c kh·ªèe, h·∫°nh ph√∫c v√† th√†nh c√¥ng r·ª±c r·ª°!";
            } else {
                // D√†nh cho Member
                qrTitle.innerText = "L√¨ x√¨ may m·∫Øn ƒë·∫ßu nƒÉm";
                qrImgMain.src = "qr-member.jpg";
                btnDownload.href = "qr-member.jpg";
                finalMsg.innerText = "Tuy gi√° tr·ªã l√¨ x√¨ kh√¥ng l·ªõn, nh∆∞ng hy v·ªçng n√≥ s·∫Ω mang l·∫°i cho em ch√∫t ni·ªÅm vui v√† may m·∫Øn trong ng√†y ƒë·∫ßu nƒÉm. Ch√∫c em m·ªôt nƒÉm m·ªõi tr√†n ƒë·∫ßy nƒÉng l∆∞·ª£ng v√† code kh√¥ng bao gi·ªù c√≥ bug nh√©! ^^";
            }

            // Hi·ªÉn th·ªã
            document.getElementById('resultModal').style.display = 'none';
            document.getElementById('content').style.display = 'none';
            document.getElementById('qrOverlay').style.display = 'flex';
        }

        function closeQR() {
            document.getElementById('qrOverlay').style.display = 'none';
            document.getElementById('content').style.display = 'block';
        }

        function openLightbox(imgSrc) {
            const lightbox = document.getElementById("qrLightbox");
            const lightboxImg = document.getElementById("lightboxImg");
            lightboxImg.src = imgSrc; 
            lightbox.style.display = "flex"; 
        }

        function closeLightbox() {
            document.getElementById("qrLightbox").style.display = "none";
        }

        function createFlower() {
            const flower = document.createElement('div');
            flower.className = 'flower';
            flower.innerHTML = Math.random() > 0.5 ? 'üå∏' : 'üåº'; 
            flower.style.left = Math.random() * 100 + 'vw';
            flower.style.fontSize = (Math.random() * 20 + 10) + 'px';
            const duration = Math.random() * 5 + 5;
            flower.style.animation = `fall ${duration}s linear forwards`;
            document.body.appendChild(flower);
            const style = document.createElement('style');
            style.innerHTML = `@keyframes fall { to { transform: translateY(110vh) rotate(${Math.random() * 360}deg); } }`;
            document.head.appendChild(style);
            setTimeout(() => { flower.remove(); style.remove(); }, duration * 1000);
        }

        function createFirework() {
            const shell = document.createElement('div');
            shell.className = 'firework-shell';
            shell.style.left = Math.random() * 90 + 5 + 'vw';
            shell.style.top = Math.random() * 60 + 10 + 'vh';
            document.body.appendChild(shell);
            const colors = ['#ff0000', '#ffff00', '#00ff00', '#00ffff', '#ff00ff', '#ffaa00', '#ffffff'];
            const color = colors[Math.floor(Math.random() * colors.length)];
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'firework-particle';
                particle.style.backgroundColor = color;
                const size = Math.random() * 3 + 2 + 'px';
                particle.style.width = size; particle.style.height = size;
                particle.style.boxShadow = `0 0 10px ${color}, 0 0 20px ${color}`;
                const angle = (i / 50) * 360 * (Math.PI / 180);
                const distance = Math.random() * 200 + 50;
                const x = Math.cos(angle) * distance + 'px';
                const y = Math.sin(angle) * distance + 'px';
                particle.style.setProperty('--x', x); particle.style.setProperty('--y', y);
                shell.appendChild(particle);
            }
            setTimeout(() => { shell.remove(); }, 1200);
        }
    </script>
</body>
</html>